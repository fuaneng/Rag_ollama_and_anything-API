该代码在调用get_details函数时只起作用一次，后续调用不会返回结果。我想要使其循环并持续执行，请帮我重新重新组织代码或添加一些机制来处理多出请求

为了使 get_details 函数能够在每次调用时重新执行所需的所有步骤，我们可以将每个步骤封装在函数中，并在每次调用 get_details 时重新执行这些函数。这种方法可以确保每次请求都重新执行所需的步骤，而不必依赖于全局的状态。
我将原来的每个步骤封装成独立的函数，并在 get_details 中按顺序调用这些函数。这样，每次调用 get_details 时，所有步骤都会被重新执行，从而保证每次请求的独立性和完整性

可以使用 requests 库来代替 subprocess 调用 curl 命令，这样可以使代码更加简洁和易读。以下是优化后的代码